<article>
  <nav>
  {#each collectLabels(spans) as label}
    <div>{label}</div>
  {/each}
  </nav>
  {#each spans as span}
    {#if span.type == 'entity' }
      <Entity text={span.text} label={(span.entity.label || "UNK")} data={span.matches} >
      </Entity>
    {:else}
      { span.text }
    {/if}
  {/each}
</article>

<script>
  import Entity from './Entity.html'

  export default {
    components: {
      Entity
    },
    helpers: {
      collectLabels(spans){
        let entitySpans = spans.filter((span)=>span.entity);
        let labels = entitySpans.map((span)=>(span.entity.label || "unk"));
        labels = labels.reduce((list, label)=>{
            if (list.indexOf(label) == -1){list.push(label)}; 
            return list},
          []);
        return labels.sort();
      }
    }
  };
</script>

<style>
	article {
		line-height: 3;
	}

  nav {
    display: flex;
  }

  nav div {
    background-color: #1aa96b;
		color: white;
		text-transform: uppercase;
		font-size: small;
		font-family: Georgia, 'Times New Roman', Times, serif;

    padding: 2px;
    margin: 2px; 
    line-height: 1;
  }
</style>

<!--
  <article>
		On <span class="ent">
			<span class="ent_text">
				<span class="ent">
					<span class="ent_text">January</span>
					<mark class="ent_label">month</mark>
				</span> 19th, 
				<span class="ent">
					<span class="ent_text">2038</span>
					<mark class="ent_label">year</mark>
				</span>
			</span>
			<mark class="ent_label">date</mark>
		</span> unix based operating systems will reach the same limit faced during the y2k scare.
  </article>
-->